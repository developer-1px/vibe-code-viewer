/**
 * Vibe Code Viewer - Main Styles
 *
 * Structure:
 * 1. Tailwind CSS base
 * 2. Import LIMN Design System (from design-system/styles/globals.css)
 * 3. Vibe-specific customizations (code themes, focus mode)
 */

/* ===== 1. Tailwind CSS ===== */
@import "tailwindcss";

/* ===== Design Tokens (Tailwind v4) ===== */
@theme {
  /* Typography Scale */
  --font-size-3xs: 9px;
  --font-size-2xs: 10px;
  --font-size-xs: 12px;

  /* Line Heights */
  --line-height-tight: 1.2;
  --line-height-snug: 1.4;
  --line-height-label: 14px;

  /* Letter Spacing */
  --tracking-label: 0.1em;
}

/* ===== 2. LIMN Design System Base ===== */
@import "./limn.css";

/* ===== 3. Vibe Code Viewer Customizations ===== */

@layer base {
  :root {
    /* Code Editor Syntax - LIMN Design System Colors */
    --code-keyword: var(--color-warm-300);        /* LIMN warm accent */
    --code-function: var(--color-status-info);    /* LIMN info blue */
    --code-class: var(--color-status-warning);    /* LIMN warning yellow */
    --code-variable: var(--color-text-primary);   /* LIMN primary text */
    --code-string: #6ee7b7;                       /* Soft emerald-300 */
    --code-number: var(--color-status-error);     /* LIMN error coral */
    --code-comment: var(--color-text-muted);      /* LIMN muted text for comments */
    --code-property: #f472b6;    /* Tailwind pink-400 - soft pink for properties */
    --code-tag: var(--color-status-warning);      /* LIMN warning yellow */
    --code-attribute: var(--color-status-info);   /* LIMN info blue */
    --code-punctuation: var(--color-text-secondary); /* LIMN secondary text */

    /* Interactive Elements - LIMN Design System */
    --code-self: var(--color-warm-300);           /* LIMN warm */
    --code-self-bg: var(--color-warm-300);
    --code-external-import: #a78bfa;              /* Violet-400 - 외부 import (보라) */
    --code-external-import-bg: #a78bfa;
    --code-external-closure: #c084fc;             /* Purple-400 - 외부 closure (연보라) */
    --code-external-closure-bg: #c084fc;
    --code-external-function: #8b5cf6;            /* Violet-500 - 외부 function (진보라) */
    --code-external-function-bg: #8b5cf6;
    --code-parameter: var(--color-status-info);   /* LIMN blue */
    --code-parameter-bg: var(--color-status-info);
    --code-local-variable: var(--color-text-secondary); /* LIMN secondary */
    --code-local-variable-bg: var(--color-warm-300); /* LIMN warm */

    /* Focus Mode Colors */
    --focus-gray: rgb(51 65 85);                  /* Unfocused grayscale */

    /* Dead Code Styles - LIMN muted tones */
    --code-dead-text: var(--color-text-muted);    /* LIMN muted (더 어둡게) */
    --code-dead-bg: rgb(255 250 245 / 0.02);      /* 매우 미묘한 배경 */
    --code-dead-border: rgb(255 250 245 / 0.04);  /* 미묘한 테두리 */
    --code-dead-decoration: rgb(255 250 245 / 0.2); /* 흐린 취소선 */

    /* Return Statement Highlight - LIMN success tone */
    --code-return-bg: var(--color-status-success-bg); /* LIMN success bg (0.1) */

    /* Identifier Hover - LIMN warm hover */
    --code-identifier-hover-bg: var(--color-warm-active-hover); /* LIMN warm hover (0.12) */

    /* Identifier Styles - LIMN warm colors with higher visibility */
    --code-identifier-bg: rgb(255 200 150 / 0.15);      /* LIMN warm, more visible */
    --code-identifier-border: rgb(255 200 150 / 0.3);   /* LIMN warm border */
    --code-identifier-def-bg: rgb(255 200 150 / 0.25);  /* LIMN warm, def more visible */
    --code-identifier-def-border: rgb(255 200 150 / 0.5); /* LIMN warm, def border stronger */
  }
}

/* ===== Custom Typography Utilities ===== */

@layer utilities {
  /* Font Sizes */
  .text-3xs {
    font-size: var(--font-size-3xs);
  }

  .text-2xs {
    font-size: var(--font-size-2xs);
  }

  /* Line Heights */
  .leading-label {
    line-height: var(--line-height-label);
  }

  /* Letter Spacing */
  .tracking-label {
    letter-spacing: var(--tracking-label);
  }
}

/* ===== Code Editor Syntax Utilities ===== */

@layer utilities {
  /* Text colors for code syntax highlighting */
  .text-editor-keyword { color: var(--code-keyword); }
  .text-editor-function { color: var(--code-function); }
  .text-editor-class { color: var(--code-class); }
  .text-editor-variable { color: var(--code-variable); }
  .text-editor-string { color: var(--code-string); }
  .text-editor-number { color: var(--code-number); }
  .text-editor-comment { color: var(--code-comment); }
  .text-editor-comment-focus { color: var(--code-comment); opacity: 1; }
  .text-editor-property { color: var(--code-property); }
  .text-editor-tag { color: var(--code-tag); }
  .text-editor-attribute { color: var(--code-attribute); }
  .text-editor-punctuation { color: var(--code-punctuation); }

  /* Generic text color */
  .text-editor-text { color: var(--code-variable); }

  /* Identifier colors - LIMN Design System */
  .text-editor-identifier {
    color: var(--color-text-primary);
    background-color: var(--code-identifier-def-bg);  /* LIMN warm (0.25) */
    border-radius: 2px;
  }
  .text-editor-identifier-def {
    color: var(--color-text-primary);
  }

  /* Interactive Elements - Text and Background */
  .text-code-self { color: var(--code-self); }
  .bg-code-self { background-color: var(--code-self-bg); }

  .text-code-external-import { color: var(--code-external-import); }
  .bg-code-external-import { background-color: var(--code-external-import-bg); }

  .text-code-external-closure { color: var(--code-external-closure); }
  .bg-code-external-closure { background-color: var(--code-external-closure-bg); }

  .text-code-external-function { color: var(--code-external-function); }
  .bg-code-external-function { background-color: var(--code-external-function-bg); }

  .text-code-parameter { color: var(--code-parameter); }
  .bg-code-parameter { background-color: var(--code-parameter-bg); }

  .text-code-local-variable { color: var(--code-local-variable); }
  .bg-code-local-variable { background-color: var(--code-local-variable-bg); }

  /* Focus mode grayscale */
  .text-editor-focus-gray { color: var(--focus-gray); }

  /* Dead Code Styles */
  .text-code-dead {
    color: var(--code-dead-text);
    opacity: 0.5;
  }

  .style-code-dead-import {
    display: inline-block;
    border-radius: 0.25rem;
    background-color: var(--code-dead-bg);
    color: rgb(148 163 184 / 0.6); /* slate-400/60 */
    text-decoration: line-through;
    text-decoration-color: var(--code-dead-decoration);
    user-select: text;
    cursor: default;
  }

  /* ===== Code Token Composite Styles ===== */

  /* Self (Definition) */
  .token-self {
    display: inline-block;
    border-radius: 0.25rem;
    background-color: rgb(from var(--code-self) r g b / 0.15);
    color: var(--code-self);
    font-weight: 700;
    cursor: pointer;
    user-select: text;
    transition: background-color 150ms;
  }
  .token-self:hover {
    background-color: rgb(from var(--code-self) r g b / 0.25);
  }
  .token-self-focused {
    background-color: rgb(from var(--code-self) r g b / 0.3);
  }
  .token-self-focused:hover {
    background-color: rgb(from var(--code-self) r g b / 0.4);
  }
  .token-self-unfocused {
    color: var(--focus-gray);
    background-color: transparent;
  }
  .token-self-unfocused:hover {
    background-color: rgb(from var(--code-self) r g b / 0.1);
    color: rgb(from var(--code-self) r g b / 0.6);
  }

  /* External NPM (npm 모듈 - secondary text 톤, 배경/강조 없음) */
  .token-external-npm {
    color: var(--color-text-secondary);
    user-select: text;
  }
  .token-external-npm-focused {
    color: theme(colors.amber.500);
    font-weight: 700;
  }
  .token-external-npm-unfocused {
    color: var(--focus-gray);
  }

  /* External Import (로컬 모듈 - 초록색) */
  .token-external-import {
    display: inline-block;
    border-radius: 0.25rem;
    color: var(--code-external-import);
    user-select: text;
    transition: all 150ms;
  }
  .token-external-import:hover {
    background-color: rgb(from var(--code-external-import) r g b / 0.15);
  }
  .token-external-import-active {
    background-color: rgb(from var(--code-external-import) r g b / 0.15);
    font-weight: 600;
  }
  .token-external-import-active:hover {
    background-color: rgb(from var(--code-external-import) r g b / 0.2);
  }
  .token-external-import-focused {
    background-color: rgb(from var(--code-external-import) r g b / 0.2);
    font-weight: 700;
  }
  .token-external-import-focused:hover {
    background-color: rgb(from var(--code-external-import) r g b / 0.25);
  }
  .token-external-import-unfocused {
    color: var(--focus-gray);
  }
  .token-external-import-unfocused:hover {
    background-color: rgb(from var(--code-external-import) r g b / 0.1);
    color: var(--code-external-import);
  }

  /* External Closure */
  .token-external-closure {
    display: inline-block;
    border-radius: 0.25rem;
    color: var(--code-external-closure);
    font-weight: 600;
    user-select: text;
    transition: all 150ms;
  }
  .token-external-closure:hover {
    background-color: rgb(from var(--code-external-closure) r g b / 0.15);
  }
  .token-external-closure-focused {
    background-color: rgb(from var(--code-external-closure) r g b / 0.2);
    font-weight: 700;
  }
  .token-external-closure-focused:hover {
    background-color: rgb(from var(--code-external-closure) r g b / 0.25);
  }
  .token-external-closure-unfocused {
    color: var(--focus-gray);
  }
  .token-external-closure-unfocused:hover {
    background-color: rgb(from var(--code-external-closure) r g b / 0.1);
    color: var(--code-external-closure);
  }

  /* External Function */
  .token-external-function {
    display: inline-block;
    border-radius: 0.25rem;
    color: var(--code-external-function);
    font-weight: 600;
    user-select: text;
    transition: all 150ms;
  }
  .token-external-function:hover {
    background-color: rgb(from var(--code-external-function) r g b / 0.15);
  }
  .token-external-function-focused {
    background-color: rgb(from var(--code-external-function) r g b / 0.2);
    font-weight: 700;
  }
  .token-external-function-focused:hover {
    background-color: rgb(from var(--code-external-function) r g b / 0.25);
  }
  .token-external-function-unfocused {
    color: var(--focus-gray);
  }
  .token-external-function-unfocused:hover {
    background-color: rgb(from var(--code-external-function) r g b / 0.1);
    color: var(--code-external-function);
  }

  /* Parameter */
  .token-parameter {
    display: inline-block;
    border-radius: 0.25rem;
    background-color: rgb(from var(--code-parameter) r g b / 0.15);
    color: var(--code-parameter);
    font-weight: 600;
    cursor: pointer;
    user-select: text;
    transition: all 150ms;
  }
  .token-parameter:hover {
    background-color: rgb(from var(--code-parameter) r g b / 0.25);
  }
  .token-parameter-active {
    background-color: rgb(from var(--code-parameter) r g b / 0.2);
  }
  .token-parameter-active:hover {
    background-color: rgb(from var(--code-parameter) r g b / 0.3);
  }
  .token-parameter-focused {
    background-color: rgb(from var(--code-parameter) r g b / 0.3);
    font-weight: 700;
  }
  .token-parameter-focused:hover {
    background-color: rgb(from var(--code-parameter) r g b / 0.4);
  }
  .token-parameter-unfocused {
    color: var(--focus-gray);
  }
  .token-parameter-unfocused:hover {
    color: var(--code-parameter);
  }

  /* Local Variable */
  .token-local-variable {
    display: inline-block;
    border-radius: 0.25rem;
    color: var(--color-text-secondary);
    cursor: pointer;
    user-select: text;
    transition: all 150ms;
  }
  .token-local-variable:hover {
    background-color: rgb(from var(--code-local-variable-bg) r g b / 0.1);
    color: var(--code-local-variable-bg);
  }
  .token-local-variable-active {
    background-color: rgb(from var(--code-local-variable-bg) r g b / 0.2);
    color: var(--code-local-variable-bg);
    font-weight: 600;
  }
  .token-local-variable-active:hover {
    background-color: rgb(from var(--code-local-variable-bg) r g b / 0.3);
  }
  .token-local-variable-focused {
    background-color: rgb(from var(--code-local-variable-bg) r g b / 0.3);
    color: var(--code-local-variable-bg);
    font-weight: 700;
  }
  .token-local-variable-focused:hover {
    background-color: rgb(from var(--code-local-variable-bg) r g b / 0.4);
  }
  .token-local-variable-unfocused {
    color: var(--focus-gray);
  }
  .token-local-variable-unfocused:hover {
    background-color: rgb(from var(--code-local-variable-bg) r g b / 0.1);
    color: var(--code-local-variable-bg);
  }

  /* Common Utilities */
  .token-clickable { cursor: pointer; }
  .token-italic { font-style: italic; }

  /* Return Statement Highlight */
  .bg-code-return {
    background-color: var(--code-return-bg);
    border-radius: 0.25rem;
  }

  /* Identifier Hover */
  .hover-code-identifier:hover {
    background-color: var(--code-identifier-hover-bg);
  }

  /* Inactive Code Card - Grayscale Animation */
  .grayscale {
    filter: grayscale(100%);
    opacity: 0.6;
  }
}

/* ===== Custom Scrollbar ===== */

::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--color-bg-base);
}

::-webkit-scrollbar-thumb {
  background: var(--color-border-medium);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-border-warm);
}
